An attempt to implement HMF using a bidirectional approach.
